<?xml version="1.0" encoding="utf-8"?>
<mx:TitleWindow xmlns:mx="http://www.adobe.com/2006/mxml" fontSize="12" layout="absolute" 
	xmlns:component="component.*" title="History Version"   height="400" creationComplete="init()"
	showCloseButton="true" close="PopUpManager.removePopUp(this)">
	<mx:Script>
		<![CDATA[
			import common.Constants;
			import mx.managers.PopUpManager;
			import event.LogSelectEvent;
			import mx.controls.Alert;
			import mx.events.CollectionEvent;
			import mx.collections.ArrayCollection;
			import vo.SysItem;
			public var _sysItemLogs:ArrayCollection;
			public var selectedItems:ArrayCollection = new ArrayCollection(); //保存选中行
			public var logView:LogDifferenceView;
			
			[Bindable]
			public var type:int;
			[Bindable]
			public function set sysItemLogs(sysItemLogList:ArrayCollection):void{
				this._sysItemLogs=sysItemLogList;
			}
			public function get sysItemLogs():ArrayCollection{
				return this._sysItemLogs;
			}  
			private function init():void{
//				sysItemLogs.addEventListener(CollectionEvent.COLLECTION_CHANGE,onChange);
			this.addEventListener(LogSelectEvent.LOG_SELECT,onLogSelected);
			}
			 
		public function onLogSelected(evt:LogSelectEvent):void{
			selectedItems=evt.selectedItems as ArrayCollection;
		}
		private function showLogDifference():void{
			if(selectedItems.length==2){
				logView=LogDifferenceView(PopUpManager.createPopUp(this,LogDifferenceView,true));
				if(this.type!=1&&this.type!=3){
			  	 		logView.width=1200;
			  	 	}
			  	 var columns:Array=	Constants.getLogColumnArray(this.type-1,true);
			  	columns.splice(0,1);
			  	logView.sysItemLogDG.columns=	columns;
				logView.sysItemLogs=selectedItems as ArrayCollection;
				logView.close.addEventListener(MouseEvent.CLICK,function():void{PopUpManager.removePopUp(logView);});
				PopUpManager.centerPopUp(logView);
			}else{
				Alert.show("请选择两条日志进行比对。");
			}
		}	
		]]>
	</mx:Script>
	<mx:VBox width="100%" height="100%">
	<mx:ApplicationControlBar  height="100%" width="100%">	
		<component:MyDataGrid id="sysItemLogDG" dataProvider="{sysItemLogs}"  lockedColumnCount="10" 
				width="100%"	 height="80%" editable="false"/>
	</mx:ApplicationControlBar>
	<mx:ControlBar>
		<mx:Button label="退出" id="close" />
		<mx:Button label="比对版本参数" id="difference" click="showLogDifference()"/>
	</mx:ControlBar>
	</mx:VBox>
</mx:TitleWindow>
