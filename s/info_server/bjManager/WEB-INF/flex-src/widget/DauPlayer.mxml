<?xml version="1.0" encoding="utf-8"?>
<ns:Pod xmlns:mx="http://www.adobe.com/2006/mxml"  xmlns:ns="com.esria.samples.dashboard.view.*" 
	title="当日登陆玩家" 
	width="100%" height="100%"
	horizontalScrollPolicy="off"
	verticalScrollPolicy="off"	
	creationComplete="init()">
<mx:Script>
	<![CDATA[
		import window.DAUAbout;
		import vo.BaseFirstCharge;
		import mx.charts.series.items.PieSeriesItem;
		import mx.charts.HitData;
		import window.IncomeAbout;
		import mx.controls.Alert;
		import mx.rpc.events.ResultEvent;
		import mx.collections.ArrayCollection;
		[Bindable]
		public var  datas:ArrayCollection=new ArrayCollection();
		[Bindable]
		public var  param2:DAUAbout;
		[Bindable]
		public var  start:Date=null;
		private function init():void{
			
		}
		private function getDAUAboutListHandler(e:ResultEvent):void{
			datas=e.result as ArrayCollection;
//			datas.filterFunction=dealDauList;
//			param2.firstCharge2.init(total,datas);
//			param2.firstCharge3.init(total,datas);
		}
//		private function dealDauList(item:Object):Boolean{
//			
//				if(employeeNoFilter == "" || fuzzyCompare(user.employeeNo, employeeNoFilter)){
//					if(userNameFilter == "" || fuzzyCompare(user.name, userNameFilter)){
//						return true;
//				 	}          
//					else{
//						return false;
//					}	
//				}
//				else{
//					return false;
//				}	
//		}
        private function startChanged(date:Date):void{
 			if (date == null)
                start=null;              
            else
            	start=date;
        }
//        public function refresh():void{
//			getRo.getPlayerFirstCharge2(param,start,end);
//		}
        private function refreshView():void{
//        	startIndex.selectedDate=start;
//			param2.firstCharge.refresh();
			getRo.getDAUAboutListByPlayer(start);
        }
        private function dataTipFunction(o:HitData):String
			{
				var psi:PieSeriesItem=PieSeriesItem(o.chartItem);
				var s:String ="描述："+psi.item.desc +"\n"+"人数："+psi.item.num +"\n"+"占比："+ Math.round(psi.percentValue) + "%";
				return s;
			}
	]]>
</mx:Script>
	<mx:RemoteObject id="getRo" destination="ro.get" showBusyCursor="true">
 		<mx:method name="getDAUAboutListByPlayer" result="getDAUAboutListHandler(event)"/>
 	</mx:RemoteObject>
 	<mx:HBox>
 		 <mx:Label color="0x323232" text="选择日期：" />
 		 <mx:DateField id="startIndex" yearNavigationEnabled="true"
                change="startChanged(DateField(event.target).selectedDate)" color="0x000000"/>
         <mx:Button label="刷新视图" click="refreshView()"/>             
 	</mx:HBox>
	<mx:VBox  height="100%" width="100%">
		<mx:PieChart verticalCenter="true" horizontalCenter="true" id="chart" height="100%" width="100%" paddingRight="5" paddingLeft="5" color="0x323232"  
   				dataProvider="{datas}" showDataTips="true" dataTipFunction="dataTipFunction">
            <mx:series>
                <mx:PieSeries field="num"  id="pieSeries">
                    <mx:calloutStroke>
                        <mx:Stroke weight="0"  color="0x888888" alpha="1.0"/>
                    </mx:calloutStroke>
                    <mx:radialStroke>
                        <mx:Stroke weight="0" color="#FFFFFF" alpha="0.20"/>
                    </mx:radialStroke>
                    <mx:stroke>
                        <mx:Stroke  color="0" alpha="0.20" />
                    </mx:stroke>
                </mx:PieSeries>
            </mx:series>
	     </mx:PieChart>
    </mx:VBox>
</ns:Pod>
